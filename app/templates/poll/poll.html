{% extends "poll/plain_base.html" %}
{% import "bootstrap/wtf.html" as wtf %}
{% import "_macros.html" as macros %}

{% block title %}The General Opinion{% endblock %}

{% block page_content %}

<div class="row-fluid">
	<div class="row-fluid">
		<form method="post" class="form" role="form" action="/poll/{{user.username}}">
		<div class="prompt text-center col-lg-9 col-lg-offset-1 col-md-12 col-sm-12">{{ form.prompts(class="form-control cd-select") }}</div>
	</div>

	<div class="row-fluid">
		<div class="webform col-lg-9 col-lg-offset-1 col-md-12 col-sm-12 col-xs-12">
			<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
				{{ form.name(class="form-control", placeholder="Name/Alias") }}
				{% for error in form.name.errors %}
		            <span class="error_message" style="color: red">{{ error }}</span>
		        {% endfor %}
			</div>


	    <div class="row-fluid body">
			{{ form.hidden_tag() }}
				<div class="form-group">
					{{ form.prompt(class="form-control", value=0) }}
				</div>
				<div class="form-group col-lg-12 col-lg-offset-0 col-md-12 col-xs-12">
					{{ form.body(class="form-control") }}
					{% for error in form.body.errors %}
				            <span class="error_message" style="color: red">{{ error }}</span>
				        {% endfor %}
				</div>
		</div>

			<div class="row-fluid">
				<div class="form-group col-lg-4 col-md-4 col-sm-4">
					{{ form.age(class="form-control", placeholder="Age", type="number") }}
						{% for error in form.age.errors %}
				            <span class="error_message" style="color: red">{{ error }}</span>
				        {% endfor %}
				</div>
				<div class="form-group col-lg-4 col-md-4 col-sm-4">
					{{ form.gender(class="form-control", placeholder="Gender") }}
				</div>
				<div class="form-group col-lg-4 col-md-4 col-sm-4">
					{{ form.passion(class="form-control", placeholder="Profession/Passion") }}
				</div>
			</div>
			<div class="row-fluid submit-stuff">
		<div class="form-group terms col-lg-4 col-md-3 col-sm-4 col-xs-6">
			<p>By submitting you accept to your information being shared</p>
		</div>	
		<div class="form-group col-lg-3 col-lg-offset-5 col-md-offset-6 col-sm-offset-4 col-xs-6 col-md-3 col-sm-4">
			{{ form.submit(class="form-control", value="Save & Print") }}
		</div>
		</div>

	</div>

	

    </form>

	</div>
</div>

{% endblock %}

{% block scripts %}
{{ super() }}
<script>
	var idleTime = 0;
	$(document).ready(function() {

		$('#prompt').hide()

        var textarea = document.getElementById("body");
		var heightLimit = 1000; /* Maximum height: 200px */

		textarea.oninput = function() {
		  textarea.style.height = ""; /* Reset the height*/
		  textarea.style.height = Math.min(textarea.scrollHeight, heightLimit) + "px";
		};

		$('input').attr('autocomplete', 'off');		

		$( ".help" ).click(function() {
		  $( ".about" ).toggle( "fast", function() {
		    var visible_about = $('.about').is(":visible")
		
			if (visible_about) {
				console.log(visible_about)
				$('.form-group, h4, .webform').not('.help, .about').addClass('blurred').off('click');

			} else {
				$('.form-group, h4, .webform').not('.help, .about').removeClass('blurred');
			}
		  });
		});

		function marginss() {
			$('.container').css({
				position:'absolute',
				left: ($(window).width() - $('.container').outerWidth())/2,
				top: ($(window).height() - $('.container').outerHeight())/8
			});

			$('.about').css({
				position:'absolute',
				top: ($(window).height() - $('.about').outerHeight())/2
			});

		}

		$(window).resize(function(){
			marginss();
		});

		var idleInterval = setInterval(timerIncrement, 1000); // 1 minute

	    //Zero the idle timer on mouse movement.
	    $(this).mousemove(function (e) {
	        idleTime = 0;
	    });
	    $(this).keypress(function (e) {
	        idleTime = 0;
	    });

		marginss();
	});

	$( function() {	
		$( '.cd-select' ).dropdown();
	});

	function timerIncrement() {
    idleTime = idleTime + 1;
    if (idleTime > 120) { 
        window.location.href = '{{url_for("poll.home")}}'
    }

}
</script>
{{ pagedown.include_pagedown() }}
{% endblock %}

